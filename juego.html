<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Adivina el País</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

</head>

<body class="d-flex flex-column justify-content-center align-items-center">

  <h1 class="mb-4 text-primary fw-bold">Adivina el País por su Capital</h1>

  <!-- Contenedor principal del juego -->
  <div class="game-card">

    <!-- donde se muestra la capital -->
    <p id="capital" class="capital">Cargando...</p>

    <!--botones de opciones -->
    <div id="options" class="d-grid gap-2"></div>

    <!-- Mensaje de respuesta (correcto/incorrecto) -->
    <p id="feedback" class="feedback"></p>

    <!-- Botón para siguiente pregunta -->
    <button id="nextBtn" class="btn btn-success btn-next" onclick="nuevaPregunta()">Siguiente ➡️</button>
  </div>

  <a href="index.html" class="btn btn-outline-secondary mt-4">⬅️ Volver al Buscador</a>

<script>

  /* 
    VARIABLES GLOBALES
    paises  lista de todos los países obtenidos de la API
    paisCorrecto  país que corresponde a la capital mostrada
  */
  let paises = [];
  let paisCorrecto = null;


  /* 
    FUNCIÓN cargarPaises()
    Descarga los países desde la API RestCountries
    Si falla, carga datos de respaldo 
  */
  async function cargarPaises() {
    try {
      // Se pide la API con solo "name" y "capital"
      const res = await fetch("https://restcountries.com/v3.1/all?fields=name,capital");

      // Si no responde bien, usamos la lista de respaldo
      if (!res.ok) throw 0;

      // Convertimos la respuesta a JSON
      const data = await res.json();

      // Guardamos solo países que tienen capital
      paises = data.filter(p => p.capital);
    } catch {

      // Lista de reepaldo si no hay internet
      paises = [
        { name: { common: "Argentina" }, capital: ["Buenos Aires"] },
        { name: { common: "Francia" }, capital: ["París"] },
        { name: { common: "Japón" }, capital: ["Tokio"] },
        { name: { common: "Canadá" }, capital: ["Ottawa"] }
      ];
    }

    // Empieza el juego con la primera pregunta
    nuevaPregunta();
  }


  /* 
    FUNCIÓN nuevaPregunta()
    Genera una capital aleatoria y muestra 4 opciones
  */
  function nuevaPregunta() {

    // Limpio el mensaje de feedback
    feedback.textContent = "";

    // Oculto el botón "Siguiente"
    nextBtn.style.display = "none";

    // Elijo un país al azar como correcto
    paisCorrecto = paises[Math.random() * paises.length | 0];

    // Muestro la capital en pantalla
    capital.textContent = `¿De qué país es la capital "${paisCorrecto.capital[0]}"?`;

    // Array con las opciones
    const opciones = [paisCorrecto];

    // Agrego países random hasta tener 4 opciones
    while (opciones.length < 4) {
      let p = paises[Math.random() * paises.length | 0];

      // Evitar repetidos
      if (!opciones.includes(p)) opciones.push(p);
    }

    // Mezclo al azar las 4 opciones
    opciones.sort(() => Math.random() - 0.5);

    //  botones en el HTML
    options.innerHTML = opciones
      .map(p =>
        `<button class="btn btn-outline-primary btn-option" onclick="verificar('${p.name.common}')">${p.name.common}</button>`
      )
      .join('');
  }


  /* 
    FUNCIÓN verificar(sel)
    Recibe la respuesta elegida
  */
  function verificar(sel) {

    // Desactivo todos los botones para que no pulsen más
    document.querySelectorAll(".btn-option").forEach(b => b.disabled = true);

    // Si acierta
    if (sel === paisCorrecto.name.common) {
      feedback.textContent = "✅ ¡Correcto!";
      feedback.className = "feedback text-success";
    }

    // Si no acierta
    else {
      feedback.textContent = `❌ Incorrecto. Era ${paisCorrecto.name.common}`;
      feedback.className = "feedback text-danger";
    }

    // Muestro botón "Siguiente"
    nextBtn.style.display = "block";
  }

  // Llamo a la función al cargar la página
  cargarPaises();
/*
Bootstrap 5.3.3
Recurso utilizado: Sistema de estilos y componentes CSS.
Fuente: https://getbootstrap.com/
CDN usado: jsDelivr
Autor: Bootstrap Team 
Licencia: MIT License

API RestCountries
Recurso utilizado: Datos de países y capitales.
URL de API: https://restcountries.com/
Autor: RestCountries Project contributors
Licencia: CC BY 4.0 – Creative Commons Attribution 4.0

MDN Web Docs (JavaScript)
Sintaxis de JavaScript, métodos, fetch, arrays, DOM.
Fuente: https://developer.mozilla.org/es/docs/Web/JavaScript
Autor: Mozilla Developer Network (Mozilla + comunidad)
Licencia: CC BY-SA 2.5

HTLM, RESPONSIVE
Sitio oficial: https://plataformas-moviles.tecnica4berazategui.edu.ar/
autor:José Yedro

*/
</script>

</body>
</html>


